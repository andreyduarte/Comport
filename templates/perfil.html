{% extends "base.html" %}
{% block content %}
    <div class="profile-header" style="text-align: center; margin-bottom: 25px;">
        <div style="font-size: 60px; margin-bottom: 10px;">👤</div>
        <h1 style="margin-bottom: 5px;">{{ username }}</h1>
        <p style="color: #6c757d; font-size: 16px;">{{ user.turma }}</p>
    </div>

    <div class="stats-grid" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 25px;">
        <div class="stat-card" style="background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); padding: 20px; border-radius: 16px; text-align: center; color: #333;">
            <div style="font-size: 30px; margin-bottom: 8px;">💰</div>
            <div style="font-size: 24px; font-weight: bold;">{{ user.pontuacao }}</div>
            <div style="font-size: 14px; opacity: 0.8;">Moedas</div>
        </div>
        
        <div class="stat-card" style="background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%); padding: 20px; border-radius: 16px; text-align: center; color: white;">
            <div style="font-size: 30px; margin-bottom: 8px;">🏆</div>
            <div style="font-size: 24px; font-weight: bold;">#{{ rank }}</div>
            <div style="font-size: 14px; opacity: 0.9;">Ranking</div>
        </div>
        
        <div class="stat-card" style="background: linear-gradient(135deg, #58cc02 0%, #7dd55c 100%); padding: 20px; border-radius: 16px; text-align: center; color: white;">
            <div style="font-size: 30px; margin-bottom: 8px;">📊</div>
            <div style="font-size: 24px; font-weight: bold;">{{ completion_percentage }}%</div>
            <div style="font-size: 14px; opacity: 0.9;">{{ answered_questions }}/{{ total_questions }} questões</div>
        </div>
    </div>

    <div class="achievement-section card">
        <h2 style="margin-bottom: 20px;">🏅 Conquistas</h2>
        
        <div class="achievements" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 15px;">
            {% for key, achievement in achievements.items() %}
                <div class="achievement unlocked">
                    <div class="achievement-icon">{{ achievement.icon }}</div>
                    <div class="achievement-name">{{ achievement.name }}</div>
                    <div class="achievement-desc">{{ achievement.desc }}</div>
                </div>
            {% endfor %}
            
            {% if achievements|length == 0 %}
                <div style="grid-column: 1 / -1; text-align: center; color: #6c757d; padding: 20px;">
                    <div style="font-size: 40px; margin-bottom: 10px;">🎯</div>
                    <p>Continue jogando para desbloquear conquistas!</p>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="edit-profile card">
        <h2 style="margin-bottom: 20px;">⚙️ Editar Perfil</h2>
        <form action="{{ url_for('perfil') }}" method="post">
            <label for="turma">Turma:</label>
            <select name="turma" id="turma" style="width: 100%; padding: 16px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 16px; margin: 8px 0; background: white;">
                <option value="{{ user.turma }}" selected>{{ user.turma }}</option>
                {% if user.turma != 'Manhã' %}<option value="Manhã">Manhã</option>{% endif %}
                {% if user.turma != 'Noite - Sexta' %}<option value="Noite - Sexta">Noite - Sexta</option>{% endif %}
                {% if user.turma != 'Noite - Quarta' %}<option value="Noite - Quarta">Noite - Quarta</option>{% endif %}
                {% if user.turma == 'Professor' %}<option value="Professor">Professor</option>{% endif %}
            </select>
            
            <label for="senha">Nova Senha (opcional):</label>
            <input type="password" name="senha" id="senha" placeholder="Deixe em branco para manter a atual">
            
            <button type="submit" class="btn">Salvar Alterações ✨</button>
        </form>
    </div>

    <div style="margin-top: 30px; text-align: center;">
        <a href="{{ url_for('logout') }}" class="btn btn-danger">Sair da Conta 🚪</a>
    </div>

    <style>
        .achievement {
            text-align: center;
            padding: 15px 10px;
            border-radius: 12px;
            transition: all 0.3s;
        }
        
        .achievement.unlocked {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0fff0 100%);
            border: 2px solid #58cc02;
        }
        
        .achievement.locked {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            opacity: 0.6;
        }
        
        .achievement-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .achievement-name {
            font-size: 12px;
            font-weight: bold;
            color: #333;
            margin-bottom: 4px;
        }
        
        .achievement-desc {
            font-size: 10px;
            color: #6c757d;
        }
        
        .stat-card {
            animation: float 3s ease-in-out infinite;
        }
        
        .stat-card:nth-child(2) {
            animation-delay: 1.5s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
    </style>
{% endblock %}